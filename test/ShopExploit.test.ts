
import { expect } from "chai";
import { BigNumber } from "ethers";
import { deployments, ethers, getNamedAccounts} from "hardhat";
import "hardhat-deploy-ethers";

describe("ShopExploiter", async () =>{

    it("Should get funds from other accounts",async()=>{
        await deployments.fixture(["Shop","ShopExploiter"])
        const {exploiter}= await getNamedAccounts()
        const exploiterAcc=await ethers.getSigner(exploiter)

        const shopDeployment=await deployments.get('Shop')
        const shopExploiterDeployment=await deployments.get('ShopExploiter')
        const shop = await ethers.getContractAt('Shop',shopDeployment.address)
        const shopExploiter = await ethers.getContractAt('ShopExploiter',shopExploiterDeployment.address)

        await shopExploiter.exploit()

        console.log(`Price after exploit: ${await shop.price()}`)
        expect((await shop.price()).eq(0),"Couldn't changed the price").to.be.true

    })

});
