
import { expect } from "chai";
import { BigNumber } from "ethers";
import { deployments, ethers, getNamedAccounts} from "hardhat";
import "hardhat-deploy-ethers";

describe("ElevatorExploit", async () =>{

    it("Should go to the top",async()=>{
        await deployments.fixture(["Elevator","BuildingImplementation"])
        const {exploiter}= await getNamedAccounts()
        const exploiterAcc=await ethers.getSigner(exploiter)

        const elevatorDeployment=await deployments.get('Elevator')
        const buildingImplementationDeployment=await deployments.get('BuildingImplementation')
        const elevator = await ethers.getContractAt('Elevator',elevatorDeployment.address)
        const buildingImplementation = await ethers.getContractAt('BuildingImplementation',buildingImplementationDeployment.address)


        console.log(`Elevator is on top: ${await elevator.top()}`)
        await buildingImplementation.connect(exploiterAcc).goToTop()
        expect(await elevator.top(),"Elevator is not on the top").to.be.true

    })

});
