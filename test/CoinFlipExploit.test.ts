
import { expect } from "chai";
import { deployments, ethers} from "hardhat";
import "hardhat-deploy-ethers";

describe("CoinFlipExploit", async () =>{

  it("Should make 10 consecutives correct answers", async () =>{
    await deployments.fixture(["CoinFlip","CoinFlipExploit"])
    const coinFlipExploitDeployment=await deployments.get('CoinFlipExploit')
    const coinFlipDeployment=await deployments.get('CoinFlip')
    
    const coinFlipExploit = await ethers.getContractAt('CoinFlipExploit',coinFlipExploitDeployment.address)
    const coinFlip = await ethers.getContractAt('CoinFlip',coinFlipDeployment.address)
    
    for(let i = 0; i<10; i++){
      await coinFlipExploit.flip()
    }

    expect(await coinFlip.consecutiveWins(),"Not equal to 10").to.be.equal(10)
  });
});
